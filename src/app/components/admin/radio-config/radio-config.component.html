<div id="radioconf">
    <h2 *ngIf="isAdmin" i18n="@@radioconft">
        Radio Configuration
    </h2>
    <div *ngIf="radio.bypass">
        <div class="flexible">
            <div class="greencircle" title='uuardop'></div>
            <div i18n="@@bypasson">Transmitting</div>
        </div>
    </div>
    <div *ngIf="!radio.bypass">
        <div class="flexible">
            <div class="redcircle" title='uuardop'></div>
            <span i18n="@@bypassoff">Inactive</span>
        </div>
    </div>

    <h2 *ngIf="!isAdmin" i18n="@@radioinfo">Radio Information</h2>

    <div i18n="cannotaccessradio" class="alert" *ngIf="!radio">Alert: Cannot access radio<br /></div>
    <div>
        <audio id="audioTag"></audio>
        <form *ngIf="radio">
            <div class="flexible">
                <div class="card">
                    <div class="row">
                        <h3>
                            <span i18n="@currentradiofreq"> {{radio.freq / 1000}} </span>
                            kHz
                            <br />
                            Current Radio frequency
                        </h3>
                    </div>
                </div>
                <div class="card">
                    <div class="row">
                        <h3>
                            <span i18n="@reflected">XXXX</span>
                            V
                            <br />
                            SWF
                        </h3>
                    </div>
                </div>
                <div class="card">
                    <div class="row">
                        <h3><span i18n="@reflected">REF </span>
                            {{radio.ref_volts}} V
                            <br />
                            ({{radio.ref_raw}}/1023)
                        </h3>
                    </div>
                </div>
                <div class="card">
                    <div class="row">
                        <h3>
                            <span i18n="@forward"> FWD </span>
                            {{radio.fwd_watts}} W
                            <br />
                            ({{radio.fwd_raw}}/1023)
                        </h3>
                    </div>
                </div>
                <div class="card">
                    <div class="row">
                        <h3>
                            <div *ngIf="radio.tx" i18n="@@operationtx1"> TX <br /> Operation mode </div>
                            <div *ngIf="radio.rx" i18n="@@operationrx"> RX <br /> Operation mode </div>
                        </h3>
                    </div>
                </div>
                <div class="card">
                    <div class="row">
                        <h3>
                            <div i18n="@@serial"> {{radio.serial}} <br /> Serial Number </div>
                        </h3>
                    </div>
                </div>
            </div>

            <div *ngIf="isAdmin">
                <div class="flex-right m-t-25">
                    <button *ngIf="radio.protection" (click)="resetProtection()" i18n="@resetprotection1">reset
                        protection</button>
                    <div class="float-right">
                        <button (click)="confirmChange()" *ngIf="!alterSet">
                            <img title="Unlock" src="assets/svg/lock.svg">
                            <span i18n="@@unlockFormRadioSettings"> Unlock</span>
                        </button>
                        <button (click)="screenSet()" *ngIf="alterSet" i18n="@@lockFormRadioSettings">
                            <img title="Lock" src="assets/svg/lock-open.svg"> Lock
                        </button>
                    </div>
                    <div class="overall" *ngIf="confirmSet && !alterSet">
                        <div class="cv">
                            <span i18n="@@areyousurechangesett">Are you sure you want to change radio settings?
                                <br />this
                                may cause the system to stop</span>
                            <br />
                            <button (click)="screenSet()" i18n="@@changer">change</button>
                            <button (click)="confirmChange()" i18n="@@cancelr0">cancel</button>
                        </div>
                    </div>
                </div>

                <div class="radio" *ngIf="radio">
                    <form #ffreq="ngForm" class="formdata field">
                        <p><span i18n="@@changefrequency">Radio frequency: {{radio.freq / 1000}} kHz</span></p>
                        <button class="midbt" (click)="changeFrequency(ffreq)" [disabled]="ffreq.invalid"
                            [disabled]="!alterSet">change
                            frequency</button>
                        <input type="number" [min]="freqmin" [max]="freqmax" class="midbt" name="frek"
                            [(ngModel)]="frek" value={{frek}} [disabled]="!alterSet">
                    </form>

                    <form *ngIf="radio" #fmode="ngForm" class="formdata field">
                        <p><span i18n="@@changeradiomode">Radio mode: {{radio.mode}}</span></p>
                        <button class="midbt" type="submit" (click)="changeMode(fmode)"
                            [disabled]="fmode.invalid || !alterSet" i18n="@@changemode1">change mode</button>
                        <label><input class="inl" type="radio" name="mode" [(ngModel)]="mode" value="USB"
                                [checked]="radio.mode=='USB'">USB</label>
                        <label><input class="inl" type="radio" name="mode" [(ngModel)]="mode" value="LSB"
                                [checked]="radio.mode=='LSB'" [disabled]="!alterSet">LSB</label>
                    </form>

                    <form #frefthreshold="ngForm" class="formdata field" *ngIf="radio">
                        <p><span i18n="@@prottheshold">Protection activation threshold level:</span>
                            {{radio.refthreshold}}</p>
                        <button class="midbt" (click)="changeRefThreshold(frefthreshold)"
                            [disabled]="frefthreshold.invalid" i18n="@@changetre1" [disabled]="!alterSet">change
                            threshold</button>
                        <input type="number" [max]="1023" class="midbt" name="refthreshold" [(ngModel)]="refthreshold"
                            value={{refthreshold}} [disabled]="!alterSet">
                    </form>

                    <form #fbfo="ngForm" class="formdata field" novalidate>
                        <p><span i18n="@@bfobeatfreq">BFO beat frequency oscillator:</span> </p>
                        <input type="number" class="midbt" name="bfo" value={{radio.bfo}} [(ngModel)]="radio.bfo"
                            [disabled]="!alterSet">
                        <button class="midbt" type="submit" i18n="@@changebfo1" (click)="changeBfo(fbfo)"
                            [disabled]="fbfo.invalid || !alterSet">change bfo</button>
                    </form>

                    <form #fmaster="ngForm" class="formdata field" novalidate>
                        <p><span i18n="@@mastercall2">mastercal:</span> </p>
                        <input class="midbt" name="mastercal" [(ngModel)]="mastercal" value={{radio.mastercal}}
                            [disabled]="!alterSet">
                        <button class="midbt" type="submit" (click)="changeMasterCall(fmaster)"
                            [disabled]="fmaster.invalid || !alterSet" i18n="@@changemast">change mastercall</button>
                    </form>

                    <form #fptt="ngForm" class="formdata field">
                        <p><span>PTT:</span></p>
                        <button type="submit" name="ptt" value="ON" *ngIf="radio.rx"
                            (click)="changePtt('ON');updateFwd()" [disabled]="!alterSet">Turn ON</button>
                        <button type="submit" name="ptt" value="OFF" *ngIf="radio.tx"
                            (click)="changePtt('OFF');stopUpdate()" [disabled]="!alterSet">Turn OFF</button>
                    </form>
                    <form #ftesttone="ngForm" class="formdata field">
                        <p><span i18n="@@testtonec">Test Tone:</span> <span> {{radio.testtone}}</span></p>

                        <div *ngIf="!toneOn" style="align-self: center;">
                            <button name="testtone" value="600" (click)="testTone(600)" title="600hz"
                                [disabled]="!alterSet">600hz</button>
                            <button name="testtone" value="1500" (click)="testTone(1500)" title="1500hz"
                                [disabled]="!alterSet">1500hz</button>
                            <button name="testtone" value="3000" (click)="testTone(3000)" title="300hz+2700hz"
                                [disabled]="!alterSet">300hz+2700hz</button>

                        </div>
                        <div *ngIf="toneOn" style="align-self: center;">
                            <button name="testtone" *ngIf="toneOn " value="0" (click)="testTone(0)"
                                [disabled]="!alterSet">shut down</button>
                        </div>
                    </form>

                    <!--
                        <form #fbypass="ngForm" class="formdata field"   >
                            <p><span i18n="@@bypass2">ByPass:</span></p>
                            <button name="bypass" value="true" [hidden]="bypass" (click)="changeByPass('ON')" i18n="@@bypassin2" >Turn on bypass</button>
                            <button name="bypass" value="false" [hidden]="!bypass" (click)="changeByPass('OFF')" i18n="@@bypassoff2">Turn off bypass</button>
                        </form>
                        -->
                </div>
                <hr>
                <button *ngIf="isAdmin" i18n="@@resettodefault" (click)="confirmReset()" [disabled]="!alterSet">reset to
                    default</button>
                <div class="overall alert" *ngIf="!reseting==false">
                    <div class="cv">
                        <span i18n="@@confirmreset"> Are you sure you want to reset the radio to the default
                            configuration?
                            <br />
                            <br />
                        </span>
                        <span class="icon"><a (click)="confirmReset()">
                                <button i18n="@@cancelr">cancel</button></a>
                        </span>
                        <span class="icon" *ngIf="isAdmin"><a (click)="resetRadio()">
                                <button i18n="@@reset1">reset</button></a>
                        </span>
                    </div>
                </div>
            </div>
            <div class="overall alert" *ngIf="errorAlert==true">
                <div class="cv">
                    <span i18n="@@errorchangingconfig">There was an error on changing configuration <br /><br /></span>
                    <span>{{error}}</span>
                    <div class="icon"><a (click)="closeError()">
                            <img title="close" src="assets/svg/x.svg"></a>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>