
<div class="">
    <h2 i18n="@@admmanage">User Management</h2>



    <h3 [hidden]="isEditing">Users</h3>
    <h3 [hidden]="!isEditing">Edit user</h3>
    <!--
    <label >is admin: <input type="checkbox"  (change)="loggedin()" name="isadmin" checked>
    </label>
    -->

    <button i18n="@@createadm" (click)="newUser()" [hidden]="isEditing">create user</button>

    <!-- test
        <button i18n="@@createadm"><a routerLink="/users">create user</a></button>
    <div>{{isadmin}}</div>
    <div>{{isadmin}}</div>

    <div [hidden]="isadmin&&!isEditing">teste1</div>
    <div [hidden]="isadmin||!isEditing">teste2</div>
    <div [hidden]="isadmin&&isEditing">teste3</div>
    <div [hidden]="!isadmin&&isEditing">teste4</div>
    <div [hidden]="!isadmin||isEditing">teste5</div>

<hr>
    <div [hidden]="isadmi==true&&isEditing==false">teste1</div>
    <div [hidden]="isadmin==true||isEditing==false">teste2</div>
    <div [hidden]="isadmin==true&&isEditing==true">teste3</div>
    <div [hidden]="isadmin==false&&isEditing==false">teste4</div>
    <div [hidden]="isadmin==false||isEditing==false">teste5</div>

    -->

    <ng-container >

        <input [hidden]="isEditing==true||isadmin==false" [(ngModel)]="searchUser"/>

        <ul id="userlist" class="multiplist" ng-model="selectedUser" [hidden]="isEditing==true||isadmin==false">
            <li *ngFor="let user of users | filter:searchUser" (click)="onSelect(user)">{{user.name}} | {{user.location}}</li>
        </ul>
    </ng-container>
    <ng-container *ngIf="selectedUser">
        <form [hidden]="isEditing==false" #f="ngForm" id="userdata" class="formdata"  novalidate>
            <label>
                <span i18n>ID</span>
                {{selectedUser.id}}
                <br/>
            </label>
            <label for="login">
                <span i18n>username</span>:
                <br/><input [hidden]="!emptyUser" name="email" [(ngModel)]="selectedUser.email" ngControl="userName" appSameUsername required  placeholder="write the username" />
                <span [hidden]="emptyUser"> {{selectedUser.email}} </span>
            </label>

            <label for="name">
                <span i18n>name</span>:
                <input name="name" [(ngModel)]="selectedUser.name" required placeholder="write the username" />
            </label>
            <label>
                <span i18n>phone number</span>:
                <br/><input name="phone" [(ngModel)]="selectedUser.phone"  placeholder="phone number"  />
            </label>

            <label >
                <span i18n>site</span>:
                <br/><input name="site" [(ngModel)]="selectedUser.site" placeholder="website"  />
            </label>

            <div class="selector">
            <span i18n="@@selectstation">station
            </span>:
            <ng-container *ngIf="stations">

                <select ng-model="selectedUser.location">
                    <option *ngFor="let station of stations">{{station.name}} | {{station.location}}</option>

                </select>
                </ng-container>
            </div>

            <!--
            <label>
                <span i18n>location</span>:
                <br/><input name="location" [(ngModel)]="selectedUser.location"  placeholder="location"  />
            </label>
            -->

            <label>
                <span i18n>password</span>:
                <br/><input name="password" type="password" [(ngModel)]="selectedUser.password" required  placeholder="password"   />
            </label>
            <label>
                <span i18n>recovery phrase</span>:
                <br/><input  name="recoverphrase" [(ngModel)]="selectedUser.recoverphrase" required placeholder="write a question to recover your password" />
            </label>
            <label>
                <span i18n>recovery answer</span>:
                <br/><input  name="recoveranswer" [(ngModel)]="selectedUser.recoveranswer" placeholder="answer to your recovery question"  />
            </label>

            <!--
            <hr>
                <span i18n>created at</span>: <span> {{selectedUser.created_at}}</span>
                <span i18n>updated at</span>: <span> {{selectedUser.updated_at}}</span>
            -->

            <hr>

            <label>
                <span i18n>is admin</span>:
                <input name="admin" class="ckbx" type="checkbox" [(ngModel)]="selectedUser.admin"  />
            </label>
            <br/>
                <button (click)="cancelCreate()" >cancel</button>

                <button (click)="deleteAlert()" [disabled]="selectedUser.admin" >delete user</button>
                <button type="submit" (click)="updateAlert()" [disabled]="f.invalid">update</button>
                <!--<button type="submit" (click)="onSubmitCreate(f)" [disabled]="f.invalid"><span [hidden]="newUsername==true">New user from this one</span><span [hidden]="newUsername==false">create user</span></button>-->

                <div class="overall" [hidden]="deleteUser">
                    <div class="cv">
                    Are you sure you wanna delete {{selectedUser.name}}?<br/>
                    this action cannot be undone!
                    <br/>
                    <button type="submit" (click)="onSubmitDelete(selectedUser.id)" [disabled]="f.invalid" >delete user</button>
                    <button type="submit" (click)="deleteAlert()" [disabled]="f.invalid" >cancel</button>
                </div>
                </div>

                <div class="overall" [hidden]="updateUser">
                    <div class="cv">
                    Are you sure you wanna update {{selectedUser.name}}?<br/>
                    this action cannot be undone!
                    <br/>
                    <button type="submit" (click)="onSubmitUpdate(selectedUser.id,f)" [disabled]="f.invalid">update</button>
                    <button type="submit" (click)="updateAlert()" [disabled]="f.invalid">cancel</button>
                </div>
                </div>
        </form>
    </ng-container>

</div>
